<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.kofu.infra.modules.member.MemberMapper">
    <resultMap id="resultMapObj" type="com.kofu.infra.modules.member.Member"></resultMap>
	<select id="selectList" resultMap="resultMapObj">		
		select 
			a.*
		from airLanguage_member a
	</select>
	<select id="selectOne" resultMap="resultMapObj">
		SELECT
			a.user_id
			,a.user_pw
			,a.user_name
			,a.user_dob
			,a.user_conutry
			,a.user_level
			,a.user_gender
			,a.user_useNy
			,a.user_delNy
			,a.user_addr
			,a.user_email
		FROM airLanguage_member a
		WHERE 1=1
			 AND memberSeq = #{memberSeq}
	</select>
	<!-- 관리자용 insert -->
	<insert id="insert">
		INSERT INTO airLanguage_member(
			user_id
			,user_pw
			,user_name
			,user_dob
			,user_conutry
			,user_level
		)
		VALUES(
			#{user_id}
			,#{user_pw}
			,#{user_name}
			,#{user_dob}
			,#{user_conutry}
			,#{user_level}
		)
		<selectKey resultType="String" keyProperty="memberSeq" order="AFTER">
			SELECT last_insert_id()
		</selectKey> 
	</insert>
	
	<insert id="signup">
		INSERT INTO airLanguage_member(
			user_id
			,user_name
			,user_pw
			,user_dob
			,user_email
			,user_favoriteLanguage
			,user_conutry
		)
		VALUES(
			#{user_id}
			,#{user_name}
			,#{user_pw}
			,#{user_dob}
			,#{user_email}
			,#{user_favoriteLanguage}
			,#{user_conutry}
		)	
		<selectKey resultType="String" keyProperty="memberSeq" order="AFTER">
			SELECT last_insert_id()
		</selectKey> 
	</insert>
	
	<!-- 중복체크 -->
	<select id="selectOneIdCheck" resultType="Integer">
		select count(*) 
		from airLanguage_member 
		where 1=1
			and user_id = #{user_id}
	</select>
	
	
	<!-- 9월 27일 로그인  -->
	<select id="selectOneId" resultMap="resultMapObj">
		SELECT
			a.memberSeq
			,a.user_id
		FROM
			airLanguage_member a
		WHERE 1=1
			AND a.user_id = #{user_id}
	</select>
	
	<select id="selectOneLogin" resultMap="resultMapObj">
		SELECT
			a.user_id
			,a.memberSeq
			,a.user_name
		FROM
			airLanguage_member a
		WHERE 1=1
			AND a.user_id = #{user_id}
			<if test="user_pw != null and !user_pw.equals('')">AND a.user_pw = #{user_pw}</if>
	</select>
</mapper>	